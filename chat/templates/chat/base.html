<!DOCTYPE HTML>

<head>
	{% block htmlhead %}

	<title>Freespeech</title>

    <meta charset="utf-8">

	{% load staticfiles %}

    <!-- FAVICON -->
    <link rel="icon" type="image/png" href="{% static 'chat/images/favicon.png' %}">

    <!-- CSS -->
    <link rel="stylesheet" href="{% static 'chat/css/jquery.fs.tipper.css' %}" />
    <link rel="stylesheet" href="{% static 'chat/generated/css/v2/style.css' %}" />
    <link href='http://fonts.googleapis.com/css?family=PT+Sans+Narrow:400,700' rel='stylesheet' type='text/css'>

    <!-- SCRIPTS -->
    <!-- UI libraries -->
    <script src="{% static 'chat/js/lib/jquery.min.js' %}"></script>
	<script src="{% static 'chat/js/lib/bootstrap.min.js' %}"></script>
	<script src="{% static 'chat/js/lib/particles.js' %}"></script>
    <!-- Cryptographic libraries -->
	<script src="{% static 'chat/js/lib/crypto/aes.js' %}"></script>
	<script src="{% static 'chat/js/lib/crypto/jscrypt.js' %}"></script>
	<script src="{% static 'chat/js/lib/crypto/aesprng.js' %}"></script>
	<script src="{% static 'chat/js/lib/crypto/entropy.js' %}"></script>
	<script src="{% static 'chat/js/lib/crypto/md5.js' %}"></script>
    <script src="{% static 'chat/js/lib/crypto/sha3.js' %}"></script>
    <!-- 
    <script src="{% static 'chat/js/lib/jquery.velocity.min.js' %}"></script>
    <script src="{% static 'chat/js/lib/velocity.ui.js' %}"></script>
    <script src="{% static 'chat/js/lib/jquery.fs.tipper.js' %}"></script>
    <script src="{% static 'chat/js/ajax.js' %}"></script>
    <script src="{% static 'chat/js/bootstrap-switch.min.js' %}"></script>
    <script src="{% static 'chat/js/alerts.js' %}"></script>
	<script src="{% static 'chat/js/crlfy.js' %}"></script>
	<script src="{% static 'chat/js/linkify.js' %}"></script>
	<script src="{% static 'chat/js/smilify.js' %}"></script>
	<script src="{% static 'chat/js/jquery.slimscroll.min.js' %}"></script>
    -->
    <!-- Other scripts -->
	<script src="{% static 'chat/js/form_check.js' %}"></script>
	<script src="{% static 'chat/js/key_management.js' %}"></script>
	<script src="{% static 'chat/js/init.js' %}"></script>
	{% endblock %}
</head>

<body>
    <div id="main-content-wrapper">
        <header>
            <h1><a href="{% url 'home' %}">FreeSpeech</a></h1>

            <blockquote>« Whereof one cannot speak, thereof one must be silent. »</blockquote>

            <nav>
                {% if not user.is_authenticated %}
                    <a id="login-button">Log in</a> | <a id="register-button">Register</a>
                {% else %}
                <span id="user-name">{{ user|truncatechars:20 }}</span><span id="menu-button"><span></span></span>
                {% endif %}
            </nav>
        </header>

        <section id="content">
            {% block content %}
            {% endblock %}
        </section>

        {% if not user.is_authenticated %}
            <div id="login-panel">
                <form id="login-form" action="{% url 'login' %}" method="post">
                    <h3 class="title">Login</h3>
                    {% csrf_token %}
                    <input name="username" type="login" class="form-control" placeholder="username">
                    <input name="password" type="password" class="form-control" placeholder="password">
                    <input type="submit" class="btn btn-default" value="Log in &#8594;">
                </form>
            </div>
        {% endif %}

        {% if not user.is_authenticated %}
            <div id="register-panel">
                <form class="formContainer" method="post" action="{% url 'register' %}" id="register-form">
                    <h3 class="title">Register</h3>
                    {% csrf_token %}
                        {% for field in registerForm %}
                                {{ field }}
                        {% endfor %}
                        <input class="form-control" id="beta_key" name="beta_key" placeholder="beta key" type="text" />
                        <p class="hint betakey">This site is still under development. For now, you need to have an inscription key to be able to register. If you don't have one, you can ask for it at fsp@udtq.fr.</p>
                        <input class="btn btn-default" type="submit" value="Register &#8594;">
                </form>
            </div>
        {% endif %}

        <div id="particle" class="background">
            <div class="triangle-1"></div>
            <div class="triangle-2"></div>
            <div class="triangle-3"></div>
            <div class="triangle-4"></div>
        </div>
    </div>

    <aside>
        <section id="my-comptoirs">
            <h2>Comptoirs</h2>
            <ul>
                {% for c, n in user.comptoirs reversed %}
                     <a class="cmptr-link" value="{{ c.id }}" href="{% url "join_comptoir" c.id %}">
                        <li id="my-{{ c.id }}" {% if c.title_is_ciphered %}class="ciphered"{% endif %}><span class="txt">{{ c.title }}</span></li>
                    </a>
                {% endfor %}
            </ul>
        </section>
        <section id="menu-bottom">
            {% if user.is_authenticated %}
            {% endif %}
        </section>
    </aside>

    <script>
        var glyphicon_options = '<span class="glyphicon-options invisible">'
            + '<span class="glyphicon glyphicon-edit"></span>'
            + '<span class="glyphicon glyphicon-remove"></span></span>';
    </script>

    <!-- 
	<script src="{% static 'chat/js/ZeroClipboard.min.js' %}"></script>
    -->

    {% if user.is_authenticated %}
    <script type="text/javascript">
        var ws_msg_url = "{% url "ws_msg" %}";
        var ws_wizz_url = "{% url "ws_wizz" %}";
        var ws_edit_url = "{% url "ws_edit" %}";
        var ws_identicate_url = "{% url "ws_identicate" %}";
        var ws_uri = "{{ WEBSOCKET_URI }}";
        var ws_heartbeat = "{{ WS4REDIS_HEARTBEAT }}";
    </script>
    <!--
    <script type="text/javascript" src="{{ STATIC_URL }}js/ws4redis.js"></script>
    <script src="{% static 'chat/js/msg-management.js' %}"></script>
	<script src="{% static 'chat/js/chat.js' %}"></script>
    <script src="{% static 'chat/js/websocket.js' %}"></script>
    <script src="{% static 'chat/js/ajax-cmptr.js' %}"></script>
    <script src="{% static 'chat/js/ui/scroll.js' %}"></script>
    -->
    {% endif %}
    

    {% block additionnal_script %}{% endblock %}
</body>

</html>
